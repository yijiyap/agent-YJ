import { deleteApp } from "firebase/app";
import { LRUCache } from "@posva/lru-cache";
import { logger } from "../logging.mjs";
export const LRU_MAX_INSTANCES = 100;
export const LRU_TTL = 1e3 * 60 * 5;
export const appCache = new LRUCache({
  max: LRU_MAX_INSTANCES,
  ttl: LRU_TTL,
  allowStale: true,
  // by default the cache deletes the app when getting it and it's stale
  // which creates errors about using a deleted app
  noDeleteOnStaleGet: true,
  updateAgeOnGet: true,
  updateAgeOnHas: true,
  dispose: (firebaseApp) => {
    logger.debug("Deleting Firebase app", firebaseApp.name);
    deleteApp(firebaseApp);
  }
});
